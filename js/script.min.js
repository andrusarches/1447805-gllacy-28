var myMap,loginForm=document.querySelector(".login-form"),inputLogin=document.querySelector("[name=login-login]"),inputPassword=document.querySelector("[name=login-password]"),feedbackButton=document.querySelector(".button-feedback"),popup=document.querySelector(".pop-up"),popupOverlay=document.querySelector(".pop-up-overlay"),popupClose=document.querySelector(".pop-up-close"),popupInputName=popup.querySelector("[name=feedback-name]"),popupInputEmail=popup.querySelector("[name=feedback-email]"),feedbackForm=popup.querySelector("form"),feedbackMessage=popup.querySelector("[name=feedback-message]"),isStorageSupportLogin=!0,storageLogin="",isStorageSuportFeedback=!0,storageFeedbackName="",storageFeedbackEmail="";try{storageLogin=localStorage.getItem("Login")}catch(e){isStorageSupportLogin=!1}isStorageSupportLogin&&(inputLogin.value=storageLogin),loginForm.addEventListener("submit",function(e){inputLogin.value&&inputPassword.value?isStorageSupportLogin&&localStorage.setItem("Login",inputLogin.value):e.preventDefault()}),ymaps.ready(function(){var e=new ymaps.Map("map",{center:[59.939314,30.327959],zoom:16},{searchControlProvider:"yandex#search"}),p=(ymaps.templateLayoutFactory.createClass('<div style="color: #FFFFFF; font-weight: bold;">$[properties.iconContent]</div>'),new ymaps.Placemark([59.938635,30.323118],{hintContent:"Магазин мороженого «Глэйси»"},{iconLayout:"default#image",iconImageHref:"img/pin.svg",iconImageSize:[80,140],iconImageOffset:[-40,-140]}));e.geoObjects.add(p)});try{storageFeedbackName=localStorage.getItem("FeedbackName"),storageFeedbackEmail=localStorage.getItem("FeedbackEmail")}catch(e){isStorageSuportFeedback=!1}feedbackButton.addEventListener("click",function(e){e.preventDefault(),popup.classList.add("pop-up-active"),popupOverlay.classList.add("pop-up-overlay-active"),storageFeedbackEmail?(popupInputName.value=storageFeedbackName,popupInputEmail.value=storageFeedbackEmail,feedbackMessage.focus()):popupInputName.focus()}),popupClose.addEventListener("click",function(e){popup.classList.remove("pop-up-active"),popup.classList.remove("pop-up-error"),popupOverlay.classList.remove("pop-up-overlay-active")}),window.addEventListener("keydown",function(e){27==e.keyCode&&popup.classList.contains("pop-up-active")&&(e.preventDefault(),popup.classList.remove("pop-up-active"),popup.classList.remove("pop-up-error"),popupOverlay.classList.remove("pop-up-overlay-active"))}),popupOverlay.addEventListener("click",function(e){popup.classList.contains("pop-up-active")&&(popup.classList.remove("pop-up-active"),popup.classList.remove("pop-up-error"),popupOverlay.classList.remove("pop-up-overlay-active"))}),popupInputName.required=!1,popupInputEmail.required=!1,feedbackMessage.required=!1,feedbackForm.addEventListener("submit",function(e){popupInputName.value&&popupInputEmail.value&&feedbackMessage.value?isStorageSuportFeedback&&(localStorage.setItem("FeedbackName",popupInputName.value),localStorage.setItem("FeedbackEmail",popupInputEmail.value)):(e.preventDefault(),popup.classList.remove("pop-up-error"),popup.offsetWidth,popup.classList.add("pop-up-error"),popupInputName.value||popupInputName.focus(),!popupInputName.value||popupInputEmail.value&&feedbackMessage.value||popupInputEmail.focus(),popupInputName.value&&popupInputEmail.value&&!feedbackMessage.value&&feedbackMessage.focus())});
